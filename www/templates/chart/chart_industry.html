{% extends "chart/base_chart.html" %}
{% load custom_tags %}
{% load custom_filters %}

{% block title %}行业数据{% endblock %}

{% block javascript %}
<script type="text/javascript">
var echarts,
	ecConfig,

	clickFun = function(param){
		var industryId = param.name.split('(')[1].split(')')[0];
		window.open('/stock/chart_industry/' + industryId, '_blank');
	},
	
	// 今日个股成交额环比
	renderChain = function(){
		var chainChart = echarts.init(document.getElementById('chain'));

		chainChart.setOption({
			title: {
				text: '今日行业成交额环比增长率前10'
			},
		    tooltip : {
		        trigger: 'axis',
		        formatter: function(params){
		        	return String.format(
		        		'<b>{1}</b><br/>{0}: {2} %<br/>点击查看该股历史成交额环比', 
		        		params[0]['seriesName'],
		        		params[0]['name'].split('(')[0],
		        		params[0]['value']
		        	)
		        }
		    },
		    legend: {
		        data:['成交额环比增长率'],
		        orient: 'horizontal',
				x: 'right',
				padding: [5, 40, 0, 0]
		    },
		    toolbox: {
		        show : true,
		        feature : {
		            saveAsImage : {show: true}
		        }
		    },
			calculable : false,
			xAxis : [{
		        type : 'value',
		        splitArea : {show : false}
		    }],
		    yAxis : [{
		    	type : 'category',
		    	axisLabel: {
		    		formatter: function(v){
		    			return v.split('(')[0]
		    		}
		    	},
		        data : [
		        	'计算机(1)', '采掘(2)', '机械设备(3)', '纺织服装(4)', 
		        	'房地产(5)', '电子(6)', '钢铁(7)', '传媒(8)', 
		        	'电气设备(9)', '汽车(10)'
		        ]
		        
		    }],
		    color: ['#428bca', '#428bca'],
		    series : [{
		        name:'成交额环比增长率',
		        type:'bar',
		        itemStyle: {
		        	normal: {
		        		label: {
		        			show: true,	// 每行数值
		        			position: 'right',
		        			formatter: "{c} %"
		        		}
		        	}
		        },
		        data: (function(){
		        	var d = [];

		        	_.map(_.range(0, 10), function(){
		        		d.push(Math.round(Math.random() * 10000) / 100)
		        	})

		        	return d.sort(function(a, b){ return a-b});
		        })()
		    }]
		});

		chainChart.on(ecConfig.EVENT.CLICK, clickFun);
	},
	renderChainInTotal = function(){
		var chainInTotalChart = echarts.init(document.getElementById('chain_in_total'));

		chainInTotalChart.setOption({
			title: {
				text: '今日行业成交额占沪深总成交额环比增长率前10'
			},
		    tooltip : {
		        trigger: 'axis',
		        formatter: '<b>{b}</b><br/>{a}: {c} %<br/>点击查看该股历史成交额环比'
		    },
		    legend: {
		        data:['成交额环比增长率'],
		        orient: 'horizontal',
				x: 'right',
				padding: [5, 40, 0, 0]
		    },
		    toolbox: {
		        show : true,
		        feature : {
		            saveAsImage : {show: true}
		        }
		    },
			calculable : false,
			xAxis : [{
		        type : 'value',
		        splitArea : {show : false}
		    }],
		    yAxis : [{
		    	type : 'category',
		    	axisLabel: {
		    		formatter: function(v){
		    			return v.split('(')[0]
		    		}
		    	},
		        data : [
		        	'计算机(1)', '采掘(2)', '机械设备(3)', '纺织服装(4)', 
		        	'房地产(5)', '电子(6)', '钢铁(7)', '传媒(8)', 
		        	'电气设备(9)', '汽车(10)'
		        ]
		        
		    }],
		    color: ['#428bca', '#428bca'],
		    series : [{
		        name:'成交额环比增长率',
		        type:'bar',
		        itemStyle: {
		        	normal: {
		        		label: {
		        			show: true,	// 每行数值
		        			position: 'right',
		        			formatter: "{c} %"
		        		}
		        	}
		        },
		        data: (function(){
		        	var d = [];

		        	_.map(_.range(0, 10), function(){
		        		d.push(Math.round(Math.random() * 10000) / 100)
		        	})

		        	return d.sort(function(a, b){ return a-b});
		        })()
		    }]
		});

		chainInTotalChart.on(ecConfig.EVENT.CLICK, clickFun);
	};

require(
	[
		"echarts", 
		"echarts/chart/line", 
		"echarts/chart/bar"
	],
	function(ec){
		echarts = ec;
		renderChain();
		renderChainInTotal();
	}
);
ecConfig = require('echarts/config');

$(document).ready(function(){

});

</script>
{% endblock %}

{% block css %}
<style type="text/css">

</style>
{% endblock %}

{% block chart_main%}
<div class="col-md-10 col-xs-12 pb-10">
	<div class="bottom-border bdc-bbb pt-10 pb-5 pl-10">
		<a href="/stock/chart_stock"><span class="f15 fb">个股数据</span></a>
		<span class="co8 pl-5 pr-5">|</span>
		<span class="f15 fb">行业数据</span>
	</div>
</div>
<ul class="list-inline col-md-10 col-xs-12 pt-0 pb-10">
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">计算机</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">采掘</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">机械设备</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">纺织服装</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">房地产</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">电子</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">钢铁</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">传媒</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">电气设备</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">家用电器</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">建筑材料</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">建筑装饰</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">交通运输</a>
	</li>
	<li class="mt-15">
		<a class="border-block-blue ml-5 pl-10 pr-10 pt-3 pb-3" href="/topics">汽车</a>
	</li>
</ul>
<div class="col-md-10 min-h400 col-xs-12 pt-10" id="chain">
</div>

<div class="col-md-10 min-h400 col-xs-12 pt-10" id="chain_in_total">
</div>


{% endblock %}